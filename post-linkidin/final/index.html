<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web3 Security Bug & Fix</title>

  <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-solidity.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="container">

<div class="bg"></div>

<div class="wrap">

  <!-- HEADER -->
  <div class="header">
    <span class="line"></span>
    <h1>Web3 Security Researcher:</h1>
    <span class="line"></span>
  </div>

  <!-- Profile Card -->
  <div class="profile-card">
    <img src="profile.jpeg" alt="Profile" />
    <div>
      <h2>Michael Kelling <span>¬∑ 1st</span></h2>
      <p>Solidity Smart Contract Developer | Wasder</p>
    </div>
  </div>

  <!-- Quote -->
  <div class="quote">
    For the collectFee of the owner function, we can simply check for ‚â•0,
    and transfer only the user‚Äôs balance to the caller, rather than having
    <code>address(this).balance</code>.
  </div>

  <!-- Bug Section -->
  <div class="label bug">‚úñ BUG</div>

  <div class="code-card">
    <span class="filename">Vault.sol</span>
    <pre style=" background: #0d1117;"><code class="language-solidity">
if (payment[msg.sender] <= 0)
    revert "insufficient balance";

payable(msg.sender).transfer(address(this).balance);
// allows draining all funds
    </code></pre>
  </div>

  <!-- Fix Section -->
  <div class="label fix">‚úî FIX</div>

  <div class="code-card">
    <span class="filename">Vault.sol</span>
    <pre style=" background: #0d1117;"><code class="language-solidity">
uint256 amount = payment[msg.sender];
if (amount == 0) revert InsufficientBalance();

payment[msg.sender] = 0;

(bool success, ) =
  payable(msg.sender).call{value: amount}("");
if (!success) revert TransferFailed();
    </code></pre>
  </div>

  <div class="footer">
    üõ°Ô∏è FIX: Final tool of secure-city issues suggested
  </div>

</div>
</div>
</body>
</html>
